"""Fixtures for {integration_name} tests.

Copy this file to tests/conftest.py and customize for your integration.
Replace {domain} with your integration's domain.
Replace {integration_name} with your integration's human-readable name.
"""
from __future__ import annotations

from collections.abc import Generator
from unittest.mock import AsyncMock, MagicMock, patch

import pytest

from homeassistant.const import CONF_HOST, CONF_PASSWORD, CONF_USERNAME

# Mock configuration data
MOCK_CONFIG = {
    CONF_HOST: "192.168.1.100",
    CONF_USERNAME: "admin",
    CONF_PASSWORD: "password",
}

# Mock device info returned by your client
MOCK_DEVICE_INFO = {
    "serial": "ABC123",
    "name": "Test Device",
    "model": "Model X",
    "sw_version": "1.0.0",
}

# Mock data returned by coordinator
MOCK_DATA = {
    "devices": {
        "device_1": {
            "name": "Living Room Sensor",
            "temperature": 22.5,
            "humidity": 45,
            "online": True,
        },
    },
}


@pytest.fixture
def mock_client() -> Generator[AsyncMock]:
    """Mock the client library.

    Patch the path where YOUR client is imported in your integration.
    Example: "custom_components.{domain}.MyClient"
    """
    with patch("custom_components.{domain}.MyClient", autospec=True) as mock:
        client = mock.return_value
        # Mock async methods
        client.async_connect = AsyncMock()
        client.async_disconnect = AsyncMock()
        client.async_get_device_info = AsyncMock(return_value=MOCK_DEVICE_INFO)
        client.async_get_data = AsyncMock(return_value=MOCK_DATA)
        yield client


@pytest.fixture
def mock_setup_entry() -> Generator[AsyncMock]:
    """Mock async_setup_entry to avoid full setup during config flow tests."""
    with patch(
        "custom_components.{domain}.async_setup_entry",
        return_value=True,
    ) as mock:
        yield mock


@pytest.fixture
def mock_config_entry() -> MagicMock:
    """Create a mock config entry.

    For full integration tests, use MockConfigEntry from
    pytest_homeassistant_custom_component instead.
    """
    from pytest_homeassistant_custom_component.common import MockConfigEntry

    return MockConfigEntry(
        domain="{domain}",
        data=MOCK_CONFIG,
        unique_id="test_unique_id",
        title="Test Device",
    )
